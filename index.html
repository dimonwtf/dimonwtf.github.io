<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="dimonwtf">

    <!-- open graph -->
    <meta property="og:title" content="Димон, WTF?! 26 Марта единый день протеста против коррупции высших должностных лиц России." />
    <meta property="og:url" content="https://dimonwtf.github.io" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="26 Марта единый день протеста против коррупции высших должностных лиц России." />
    <meta property="og:image" content="https://dimonmd.navalny.com/media/share_photo/1200x628-sharepic.jpg" />

    <!-- twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:url" content="https://dimonwtf.github.io" />
    <meta name="twitter:domain" content="https://dimonwtf.github.io" />
    <meta name="twitter:title" content="Димон, WTF?! 26 Марта единый день протеста против коррупции высших должностных лиц России." />
    <meta name="twitter:description" content="26 Марта единый день протеста против коррупции высших должностных лиц России." />
    <meta name="twitter:image" content="https://dimonmd.navalny.com/media/share_photo/1200x628-sharepic.jpg" />
    <meta name="twitter:site" content="@dimonwtf" />
    <meta name="twitter:creator" content="@dimonwtf" />

    <title>Димон, WTF?! 26 Марта все на митинг!</title>

    <script src="//code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script type="text/javascript" src="//cdn.datatables.net/v/bs/dt-1.10.13/datatables.min.js"></script>

    <script type="text/javascript" src="/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="/js/nano.js"></script>
    <script type="text/javascript" src="/js/share.min.js"></script>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="//cdn.datatables.net/v/bs/dt-1.10.13/datatables.min.css" rel="stylesheet" type="text/css" />
    <link href="/css/share.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
        .meeting {
            font-size: 3.35em;
            color: red;
        }
    </style>
</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Intro Section -->
    <section id="intro" class="intro-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <h1>&mdash; Димон, WTF?</h1>
                    <h2 class="meeting">Антикоррупционный митинг.</h2>
                    <h3>26 марта 2017 в 14:00, в вашем городе. Не пропустите!</h2>

                </div>

                <div class="col-lg-4">
                    <img class="col-lg-12" src="/img/caricatura.jpg"/>
                    <div class="small text-right col-lg-12"><a href="http://caricatura.ru/" target="_blank">caricatura.ru</a></div>
                </div>

                <div class="col-lg-8">
                    <h2>Статистика по городам</h2>
                    <div id="cities">
                        <table id="cities_data" class="table table-hover">
                            <thead>
                                <tr>
                                    <td>Город</td>
                                    <td>Участников</td>
                                    <td>Может придут</td>
                                    <td>Приглашённых</td>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-lg-4">

                    <h2>Общая Статистика</h2>
                    <table class="table table-hover">
                        <tr><td>Городов участвующих в акции</td><td><strong><span id="total_cities"></span></strong></td></tr>
                        <tr><td>Участников</td><td><strong><span id="attending"></span></strong></td></tr>
                        <tr><td>Может придут</td><td><span id="maybe"></span></td></tr>
                        <tr><td>Сколько ещё пригласили</td><td><span id="invited"></span></td></tr>
                    </table>

                    <h4>Поделиться</h4>
                    <ul class="rrssb-buttons clearfix">
                      <li class="rrssb-facebook">
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://dimonwtf.github.io" class="popup">
                          <span class="rrssb-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 29"><path d="M26.4 0H2.6C1.714 0 0 1.715 0 2.6v23.8c0 .884 1.715 2.6 2.6 2.6h12.393V17.988h-3.996v-3.98h3.997v-3.062c0-3.746 2.835-5.97 6.177-5.97 1.6 0 2.444.173 2.845.226v3.792H21.18c-1.817 0-2.156.9-2.156 2.168v2.847h5.045l-.66 3.978h-4.386V29H26.4c.884 0 2.6-1.716 2.6-2.6V2.6c0-.885-1.716-2.6-2.6-2.6z"/></svg></span>
                          <span class="rrssb-text">facebook</span>
                        </a>
                      </li>
                      <li class="rrssb-twitter">
                        <!-- Replace href with your Meta and URL information  -->
                        <a href="https://twitter.com/intent/tweet?text=https://dimonwtf.github.io" class="popup">
                          <span class="rrssb-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62a15.093 15.093 0 0 1-8.86-2.32c2.702.18 5.375-.648 7.507-2.32a5.417 5.417 0 0 1-4.49-3.64c.802.13 1.62.077 2.4-.154a5.416 5.416 0 0 1-4.412-5.11 5.43 5.43 0 0 0 2.168.387A5.416 5.416 0 0 1 2.89 4.498a15.09 15.09 0 0 0 10.913 5.573 5.185 5.185 0 0 1 3.434-6.48 5.18 5.18 0 0 1 5.546 1.682 9.076 9.076 0 0 0 3.33-1.317 5.038 5.038 0 0 1-2.4 2.942 9.068 9.068 0 0 0 3.02-.85 5.05 5.05 0 0 1-2.48 2.71z"/></svg></span>
                          <span class="rrssb-text">twitter</span>
                        </a>
                      </li>
                      <li class="rrssb-email">
                        <!-- Replace subject with your message using URL Encoding: http://meyerweb.com/eric/tools/dencoder/ -->
                        <a href="mailto:?Subject=Димон, WTF?!">
                          <span class="rrssb-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M20.11 26.147c-2.335 1.05-4.36 1.4-7.124 1.4C6.524 27.548.84 22.916.84 15.284.84 7.343 6.602.45 15.4.45c6.854 0 11.8 4.7 11.8 11.252 0 5.684-3.193 9.265-7.398 9.3-1.83 0-3.153-.934-3.347-2.997h-.077c-1.208 1.986-2.96 2.997-5.023 2.997-2.532 0-4.36-1.868-4.36-5.062 0-4.75 3.503-9.07 9.11-9.07 1.713 0 3.7.4 4.6.972l-1.17 7.203c-.387 2.298-.115 3.3 1 3.4 1.674 0 3.774-2.102 3.774-6.58 0-5.06-3.27-8.994-9.304-8.994C9.05 2.87 3.83 7.545 3.83 14.97c0 6.5 4.2 10.2 10 10.202 1.987 0 4.09-.43 5.647-1.245l.634 2.22zM16.647 10.1c-.31-.078-.7-.155-1.207-.155-2.572 0-4.596 2.53-4.596 5.53 0 1.5.7 2.4 1.9 2.4 1.44 0 2.96-1.83 3.31-4.088l.592-3.72z"/></svg></span>
                          <span class="rrssb-text">email</span>
                        </a>
                      </li>
                    </ul>

                    <hr/>

                    <a class="twitter-timeline"  href="https://twitter.com/search?q=%2326%D0%BC%D0%B0%D1%80%D1%82%D0%B0%20OR%20%23%D0%B3%D0%B4%D0%B5%D0%94%D0%B8%D0%BC%D0%BE%D0%BD%20OR%20%23%D0%B8%D1%89%D0%B5%D0%BC%D0%94%D0%B8%D0%BC%D0%BE%D0%BD%D0%B0%20OR%20%23dimonwtf" data-widget-id="844785765204713473">Tweets about #26марта OR #гдеДимон OR #ищемДимона OR #dimonwtf</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                    <hr/>

                    <p class="small text-right">Время последнего обновления: <span id="updated_time"></span></p>
                    <p class="small text-right">Статистика обновляется каждые 30 минут. <a href="https://vk.com/wall-55284725_272730">Источник данных</a>.</p>
                </div>

            </div>
        </div>
    </section>


    <script type="text/javascript">
        function numberWithCommas(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function sortDictByKey(dict) {
            var sorted = []
            for(var key in dict) {
                sorted[sorted.length] = key
            }
            sorted.sort()

            var tempDict = {}
            for(var i = 0; i < sorted.length; i++) {
                tempDict[sorted[i]] = dict[sorted[i]]
            }

            return tempDict
        }

        $(document).ready(function() {
            $.ajaxSetup({ cache: false })
            $.getJSON("/stats.json", function(data) {
                $("#total_cities").text(data.stats_total.total_cities);
                $("#attending").text(numberWithCommas(data.stats_total.attending));
                $("#maybe").text(numberWithCommas(data.stats_total.maybe));
                $("#invited").text(numberWithCommas(data.stats_total.invited));
                $("#updated_time").text(moment(data.updated_time).locale("ru").format("LLL"));

                // cities
                var temp = $("#city_template").text()

                var cities = sortDictByKey(data.stats_by_city)

                for (city_name in cities) {
                    var c = cities[city_name],
                        attending = 0,
                        maybe = 0,
                        invited = 0;

                    for (cnt in c.counters) {
                        var counter = c.counters[cnt]
                        attending += counter.attending
                        maybe += counter.maybe
                        invited += counter.invited
                    }

                    $("#cities > table > tbody").prepend(nano(temp, {
                        url: c.links[0],
                        city_name: c.city_name,
                        attending: numberWithCommas(attending),
                        maybe: numberWithCommas(maybe),
                        invited: numberWithCommas(invited),
                    }))
                }

                $("#cities_data").DataTable({
                    "bPaginate": false,
                    "language": {
                        "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Russian.json"
                    },
                    "order": [[ 1, "desc" ]]
                })
            })
        })
    </script>

    <script type="text/x-template" id="city_template">
        <tr>
            <td><a href="https://{url}" target="_blank">{city_name}</a></td>
            <td>{attending}</td>
            <td>{maybe}</td>
            <td>{invited}</td>
        </tr>
    </script>
</body>
</html>